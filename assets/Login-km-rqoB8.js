import{u as F}from"./index-Gt7MbQT3.js";import{L as D,M as E,S as N,_ as x,u as H}from"./LogoIcon-CDUS7YXq.js";import{b as L,k as f,l as S,m as e,n as P,r as p,w as o,e as k,f as v,u as m,p as I,q,s as $,t as M,v as B,x as T,E as b,y as j}from"./vendor-DbdYn3yV.js";const A={class:"header"},z=L({__name:"LoginHeader",setup(R){const l=F(),d=f(l.$state.isDarkMode),r=()=>{l.toggleDarkMode(),d.value=l.$state.isDarkMode};return(g,t)=>{const s=p("el-icon");return v(),S("div",A,[e(s,null,{default:o(()=>[e(m(D),{class:"logo"})]),_:1}),P("div",{class:"theme-toggle",onClick:r},[d.value?(v(),k(s,{key:1},{default:o(()=>[e(m(N))]),_:1})):(v(),k(s,{key:0},{default:o(()=>[e(m(E))]),_:1}))])])}}}),G=x(z,[["__scopeId","data-v-6f1a3dfe"]]),J={class:"form-footer"},K=L({__name:"LoginForm",props:{loading:{type:Boolean}},emits:["switch-mode","login"],setup(R,{emit:l}){T();const d=f(),r=l,g=R,t=I({phone:"",password:""}),s={phone:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],password:[{required:!0,message:"请输入密码"},{min:6,message:"密码长度不能小于6位"}]},V=async()=>{if(d.value)try{await d.value.validate(),r("login",t.phone,t.password)}catch(i){b.error(i.message||"登录失败")}},C=()=>{g.loading||r("switch-mode")};return(i,_)=>{const u=p("el-icon"),a=p("el-input"),n=p("el-form-item"),c=p("el-button"),w=p("el-form");return v(),k(w,{ref_key:"loginFormRef",ref:d,model:t,rules:s,"label-position":"left"},{default:o(()=>[e(n,{label:"",prop:"phone"},{default:o(()=>[e(a,{modelValue:t.phone,"onUpdate:modelValue":_[0]||(_[0]=h=>t.phone=h),placeholder:"请输入手机号",disabled:i.loading},{prefix:o(()=>[e(u,null,{default:o(()=>[e(m(q))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(n,{label:"",prop:"password"},{default:o(()=>[e(a,{modelValue:t.password,"onUpdate:modelValue":_[1]||(_[1]=h=>t.password=h),type:"password",placeholder:"请输入密码","show-password":"",disabled:i.loading},{prefix:o(()=>[e(u,null,{default:o(()=>[e(m($))]),_:1})]),_:1},8,["modelValue","disabled"])]),_:1}),e(c,{type:"primary",onClick:V,loading:i.loading,disabled:i.loading,class:"submit-btn",style:{width:"100%"}},{default:o(()=>[M(B(i.loading?"登录中...":"登录"),1)]),_:1},8,["loading","disabled"]),P("div",J,[e(c,{type:"text",onClick:C,disabled:i.loading,class:"forgotBtn"},{default:o(()=>_[2]||(_[2]=[M("忘记密码？")])),_:1},8,["disabled"])])]),_:1},8,["model"])}}}),O=x(K,[["__scopeId","data-v-1e1aae27"]]),Q={class:"form-footer"},W=L({__name:"ResetPasswordForm",emits:["switch-mode","reset-password","send-code"],setup(R,{emit:l}){const d=f(),r=f(!1),g=f(0),t=l,s=I({phone:"",code:"",password:"",confirmPassword:""}),V={phone:[{required:!0,message:"请输入手机号"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号"}],code:[{required:!0,message:"请输入验证码"},{len:6,message:"验证码长度为6位"}],password:[{required:!0,message:"请输入新密码"},{min:6,message:"密码长度不能小于6位"}],confirmPassword:[{required:!0,message:"请确认新密码"},{validator:(u,a)=>a!==s.password?Promise.reject("两次输入的密码不一致"):Promise.resolve()}]},C=async()=>{if(d.value)try{await d.value.validate(),r.value=!0,t("reset-password",s.phone,s.password,s.code)}catch(u){b.error(u.message||"重置失败")}finally{r.value=!1}},i=async()=>{if(!s.phone){b.warning("请输入手机号");return}try{r.value=!0,t("send-code",s.phone)}catch(u){b.error(u.message||"发送失败")}finally{r.value=!1}},_=()=>{t("switch-mode")};return(u,a)=>{const n=p("el-icon"),c=p("el-input"),w=p("el-form-item"),h=p("el-button"),U=p("el-form");return v(),k(U,{ref_key:"resetFormRef",ref:d,model:s,rules:V,"label-position":"left"},{default:o(()=>[e(w,{label:"",prop:"phone"},{default:o(()=>[e(c,{modelValue:s.phone,"onUpdate:modelValue":a[0]||(a[0]=y=>s.phone=y),placeholder:"请输入手机号"},{prefix:o(()=>[e(n,null,{default:o(()=>[e(m(q))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"",prop:"code"},{default:o(()=>[e(c,{modelValue:s.code,"onUpdate:modelValue":a[1]||(a[1]=y=>s.code=y),placeholder:"请输入验证码"},{prefix:o(()=>[e(n,null,{default:o(()=>[e(m(j))]),_:1})]),append:o(()=>[e(h,{disabled:!!g.value||r.value,onClick:i},{default:o(()=>[M(B(g.value?`${g.value}s`:"获取验证码"),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"",prop:"password"},{default:o(()=>[e(c,{modelValue:s.password,"onUpdate:modelValue":a[2]||(a[2]=y=>s.password=y),type:"password",placeholder:"请输入新密码","show-password":""},{prefix:o(()=>[e(n,null,{default:o(()=>[e(m($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(w,{label:"",prop:"confirmPassword"},{default:o(()=>[e(c,{modelValue:s.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=y=>s.confirmPassword=y),type:"password",placeholder:"请再次输入新密码","show-password":""},{prefix:o(()=>[e(n,null,{default:o(()=>[e(m($))]),_:1})]),_:1},8,["modelValue"])]),_:1}),P("div",Q,[e(h,{type:"text",onClick:_,class:"backBtn"},{default:o(()=>a[4]||(a[4]=[M("返回登录")])),_:1}),e(h,{type:"primary",onClick:C,loading:r.value,class:"submit-btn"},{default:o(()=>a[5]||(a[5]=[M(" 重置密码 ")])),_:1},8,["loading"])])]),_:1},8,["model"])}}}),X=x(W,[["__scopeId","data-v-d2170ac2"]]),Y={class:"login-container"},Z={class:"login-card"},ee=L({__name:"Login",setup(R){F();const{loading:l,login:d,resetPassword:r,sendVerificationCode:g}=H(),t=f(!1),s=f(0);f(""),f("");const V=async(a,n)=>{try{l.value=!0,await d(a,n)}catch(c){b.error(c.message||"登录失败")}finally{l.value=!1}},C=async(a,n,c)=>{try{l.value=!0,await r(a,n,c),t.value=!1}catch(w){b.error(w.message||"重置失败")}finally{l.value=!1}},i=async a=>{try{l.value=!0,await g(a),_()}catch(n){b.error(n.message||"发送失败")}finally{l.value=!1}},_=()=>{s.value=60;const a=setInterval(()=>{s.value--,s.value<=0&&clearInterval(a)},1e3)},u=()=>{t.value=!t.value};return(a,n)=>(v(),S("div",Y,[P("div",Z,[e(G),t.value?(v(),k(X,{key:1,onSwitchMode:u,onResetPassword:C,onSendCode:i,loading:m(l),countdown:s.value},null,8,["loading","countdown"])):(v(),k(O,{key:0,onSwitchMode:u,onLogin:V,loading:m(l)},null,8,["loading"]))])]))}}),te=x(ee,[["__scopeId","data-v-01cde992"]]);export{te as default};
